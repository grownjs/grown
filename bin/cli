#!/bin/sh
':' // ; exec "$(command -v nodejs || command -v node)" "$0" "$@"
;

'use strict';

/* eslint-disable global-require */

const thisPkg = require('../package.json');
const cleanStack = require('clean-stack');
const chalk = require('chalk');

const _ = require('./lib/_util');
const $ = require('./lib/_argv');

if (!$.cmd && !Object.keys($.flags).length) {
  _.echo(chalk.yellow(`Usage: ${Object.keys(thisPkg.bin)[0]} ...|repl|start\n`));
  _.die(1);
}

const _name = chalk.green(`${thisPkg.name} v${thisPkg.version}`);
const _node = chalk.gray(`node ${process.version}`);

_.echo(`${_name} ${_node}\n`);

try {
  require(`./lib/${$.cmd === 'repl' || $.cmd === 'start' ? $.cmd : 'gen'}`);
} catch (e) {
  _.echo(chalk.red(($.flags.debug && cleanStack(e.stack)) || e.message), '\n');
  _.die(1);
}
